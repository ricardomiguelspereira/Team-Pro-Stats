<!doctype html>
<html lang="pt">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Totais Estatísticas da Equipa</title>
<link rel="stylesheet" href="estatisticas.css">
<style>
  html, body { height: 100%; margin: 0; }
  body {
    font-family: "Segoe UI", Tahoma, sans-serif;
    background: #f5f5f5;
    color: #333;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    padding: 10px;
    box-sizing: border-box;
  }
  .container {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    max-height: 100%;
    width: 100%;
    overflow-y: auto;
    padding: 10px;
    box-sizing: border-box;
  }
  h1 { font-size: 1.8em; margin-bottom: 15px; text-align: center; }
  h3 { margin-top: 20px; margin-bottom: 10px; text-align: center; }
  .tabs {
    display: flex;
    gap: 10px;
    margin-bottom: 20px;
    justify-content: center;
  }
  .nav-btn {
    background: #2980b9;
    color: #fff;
    padding: 10px 20px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-weight: 500;
    transition: 0.3s;
  }
  .nav-btn:hover { background: #3498db; }
  .responsive {
    margin-bottom: 20px;
    padding: 10px;
    background: #fff;
    border-radius: 8px;
    box-shadow: 0 4px 8px rgba(0,0,0,0.05);
    max-width: 900px;
    width: 100%;
  }
  table.part-table {
    border-collapse: collapse;
    width: 100%;
    table-layout: auto;
    margin: 0 auto;
  }
  table.part-table th, table.part-table td {
    border: 1px solid #eee;
    padding: 8px;
    font-size: 13px;
    text-align: center;
  }
  table.part-table th {
    background: #2980b9;
    color: #fff;
  }
  table.part-table tr:nth-child(even) { background:#f9f9f9; }
  footer {
    width: 100%; 
    text-align: center; 
    padding: 12px 0; 
    font-size: 0.8em; 
    color: #666; 
    font-family: Tahoma, sans-serif;
  }
</style>
</head>
<body>

<div class="container">
  <h1>Totais Estatísticas da Equipa</h1>

  <h3>Jogadores de Campo</h3>
  <div class="responsive">
    <table id="totalsCampo" class="part-table">
      <thead>
        <tr>
          <th rowspan="2">Dimensão</th>
          <th colspan="2">Jogo Normal</th>
          <th colspan="2">Prolongamento</th>
          <th rowspan="2">Total</th>
        </tr>
        <tr>
          <th>1ª Parte</th>
          <th>2ª Parte</th>
          <th>1ª Parte</th>
          <th>2ª Parte</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <h3>Guarda-Redes</h3>
  <div class="responsive">
    <table id="totalsGR" class="part-table">
      <thead>
        <tr>
          <th rowspan="2">Dimensão</th>
          <th colspan="2">Jogo Normal</th>
          <th colspan="2">Prolongamento</th>
          <th rowspan="2">Total</th>
        </tr>
        <tr>
          <th>1ª Parte</th>
          <th>2ª Parte</th>
          <th>1ª Parte</th>
          <th>2ª Parte</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>
</div>

<script src="estatisticas.js"></script>
<script>
function updateTotalsWithET(){
  if(!playersCampo || !playersGR) return;
  const tbodyCampo = document.getElementById('totalsCampo').querySelector('tbody'); 
  const tbodyGR = document.getElementById('totalsGR').querySelector('tbody'); 
  tbodyCampo.innerHTML=''; tbodyGR.innerHTML='';

  const extraStats = JSON.parse(localStorage.getItem('estatisticas_extra_time') || '{}');
  const extraCampo = extraStats.campo || [];
  const extraGR = extraStats.gr || [];

  STAT_KEYS_CAMPO.forEach(st=>{
    let n1=0,n2=0,et1=0,et2=0;
    playersCampo.forEach(p=>{ n1+=p[st+'1']||0; n2+=p[st+'2']||0; });
    extraCampo.forEach(p=>{ et1+=p[st+'ET1']||0; et2+=p[st+'ET2']||0; });
    const total = n1+n2+et1+et2;
    tbodyCampo.innerHTML += `<tr><td>${LABELS[st]}</td><td>${n1}</td><td>${n2}</td><td>${et1}</td><td>${et2}</td><td>${total}</td></tr>`;
  });

  STAT_KEYS_GR.forEach(st=>{
    let n1=0,n2=0,et1=0,et2=0;
    playersGR.forEach(p=>{ n1+=p[st+'1']||0; n2+=p[st+'2']||0; });
    extraGR.forEach(p=>{ et1+=p[st+'ET1']||0; et2+=p[st+'ET2']||0; });
    const total = n1+n2+et1+et2;
    tbodyGR.innerHTML += `<tr><td>${LABELS[st]}</td><td>${n1}</td><td>${n2}</td><td>${et1}</td><td>${et2}</td><td>${total}</td></tr>`;
  });
}

window.addEventListener('load',()=>{
  init(); 
  updateTotalsWithET();
});
window.addEventListener('storage',()=>{
  loadPlayersFromConfig();
  render();
  updateTotalsWithET();
});
</script>

<footer>© 2025 Team Pro Stats · Powered by RP Technology</footer>
</body>
</html>
