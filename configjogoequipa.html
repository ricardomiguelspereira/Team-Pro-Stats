<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configurar Jogo</title>
    <style>
        /* ... (your existing styles) ... */
    </style>
</head>
<body>

<div id="container">
    <div class="header">CONFIGURAR JOGO</div>

    <div id="jogo" class="tab-content">
        <form id="jogoForm" autocomplete="off" novalidate onsubmit="return false;">
            <!-- First line: Escal√£o (reduced width) and Competi√ß√£o (3/4 bigger) -->
            <label for="escalao">Escal√£o
                <select id="escalao" name="escalao">
                    <option value="">---</option>
                    <option value="SUB-13">SUB-13</option>
                    <option value="SUB-15">SUB-15</option>
                    <option value="SUB-17">SUB-17</option>
                    <option value="SUB-19">SUB-19</option>
                    <option value="SUB-23">SUB-23</option>
                    <option value="S√âNIORES">S√âNIORES</option>
                </select>
            </label>

            <label for="competicao">Competi√ß√£o
                <input type="text" id="competicao" name="competicao" />
            </label>

            <!-- Second line: Fase and Grupo (same size) -->
            <label for="fase">Fase
                <input type="text" id="fase" name="fase" />
            </label>
            <label for="grupo">Grupo
                <input type="text" id="grupo" name="grupo" />
            </label>

            <!-- Third line: Jornada, Data, Hora (same size each) -->
            <label for="jornada">Jornada
                <input type="text" id="jornada" name="jornada" />
            </label>
            <label for="data">Data
                <input type="date" id="data" name="data" />
            </label>
            <label for="hora">Hora
                <input type="time" id="hora" name="hora" />
            </label>

            <!-- Fourth line: Local -->
            <label for="local">Local
                <input type="text" id="local" name="local" />
            </label>

            <!-- Fifth line: Advers√°rio -->
            <label for="adversario">Advers√°rio
                <input type="text" id="adversario" name="adversario" />
            </label>

            <!-- Optional: Clear button (uncomment or style to show) -->
            <!-- <button type="button" id="clearButton">Limpar Dados Salvos</button> -->
        </form>
    </div>

    <div id="notification"></div>
</div>

<script type="module" src="firebase-data.js"></script>
<script>
    // LocalStorage for Jogo Data
    const STORAGE_KEY_JOGO = FB_PATHS.jogoFormData; // Use Firebase path
    const jogoForm = document.getElementById('jogoForm');
    const notification = document.getElementById('notification');
    // const clearButton = document.getElementById('clearButton'); // Uncomment if using the button

    // Debounce function to limit save frequency on text inputs
    function debounce(func, delay) {
        let timeoutId;
        return function (...args) {
            clearTimeout(timeoutId);
            timeoutId = setTimeout(() => func.apply(this, args), delay);
        };
    }

    function showNotification(message, isError = false) {
        notification.textContent = message;
        notification.style.background = isError ? 'rgba(231, 76, 60, 0.1)' : 'rgba(52, 152, 219, 0.1)';
        notification.style.color = isError ? '#e74c3c' : 'var(--primary-color)';
        notification.style.display = 'block';
        setTimeout(() => {
            notification.style.opacity = '0';
            setTimeout(() => { notification.style.display = 'none'; notification.style.opacity = '1'; }, 300);
        }, 3000);
    }

    async function saveJogoData() {
        const data = {};
        for (const el of jogoForm.elements) {
            if (el.name) {
                data[el.name] = el.value || ''; // Capture value, default to empty string
            }
        }
        await setFirebaseData(STORAGE_KEY_JOGO, data);
        console.log('Dados salvos:', data); // For debugging
    }

    async function loadJogoData() {
        const data = await getFirebaseData(STORAGE_KEY_JOGO);
        if (data) {
            try {
                for (const [k, v] of Object.entries(data)) {
                    const input = jogoForm.elements[k];
                    if (input) {
                        input.value = v || '';
                    }
                }
                showNotification('‚úÖ Dados carregados com sucesso!');
            } catch (e) {
                console.error('Erro ao carregar dados:', e);
                showNotification('‚ùå Erro ao carregar dados salvos.', true);
                // If data is corrupted, consider deleting from Firebase
                // deleteFirebaseData(STORAGE_KEY_JOGO); 
            }
        }
    }

    async function clearJogoData() {
        await deleteFirebaseData(STORAGE_KEY_JOGO);
        jogoForm.reset(); // Reset form visually
        showNotification('üóëÔ∏è Dados salvos limpos!');
    }

    // Event Listeners
    document.addEventListener('DOMContentLoaded', async () => {
        await loadJogoData(); // Await loading data

        // Auto-save on changes
        const debouncedSave = debounce(saveJogoData, 200); // 200ms delay for text/date/time
        const allInputs = jogoForm.querySelectorAll('input, select');

        allInputs.forEach(input => {
            // For selects: save immediately on change
            if (input.tagName === 'SELECT') {
                input.addEventListener('change', saveJogoData);
            } else {
                // For text/date/time: save on input (debounced) and change (immediate on blur)
                input.addEventListener('input', debouncedSave);
                input.addEventListener('change', saveJogoData);
            }
        });

        // Optional: Clear button listener (uncomment if using the button)
        // clearButton.addEventListener('click', clearJogoData);
    });
</script>
</body>
</html>